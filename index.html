<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" /><meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>Weed Strain Tracker</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-firestore-compat.js"></script>
</head>
<body class="bg-gray-900 text-white min-h-screen px-4 py-8">

  <!-- Header -->
  <h1 class="text-4xl font-bold text-green-400 text-center mb-8">Weed Strain Tracker</h1>

  <!-- Add Strain Section -->
  <form id="strain-form" class="bg-gray-800 max-w-md mx-auto p-6 rounded-lg shadow-lg">
    <label class="block mb-2">Strain Name:</label>
    <input type="text" id="name" required class="w-full p-2 rounded bg-gray-700 text-white mb-2" placeholder="Strain Name" />

    <div class="flex items-center mb-4 space-x-2">
      <button type="button" id="lookup-leafly" class="bg-green-600 hover:bg-green-700 px-3 py-2 rounded text-black">Leafly üîç</button>
      <button type="button" id="lookup-seedsman" class="bg-green-600 hover:bg-green-700 px-3 py-2 rounded text-black">Seedsman üîç</button>
    </div>

    <label class="block mb-2">Type (Indica, Sativa, Hybrid):</label>
    <input type="text" id="type" required class="w-full p-2 rounded bg-gray-700 mb-4" />

    <label class="block mb-2">Description:</label>
    <textarea id="description" required class="w-full p-2 rounded bg-gray-700 mb-4" rows="3"></textarea>

    <label class="block mb-2">Notes:</label>
    <textarea id="notes" class="w-full p-2 rounded bg-gray-700 mb-4" rows="2" placeholder="Optional notes..."></textarea>

    <button type="submit" class="bg-green-500 hover:bg-green-600 text-black font-bold w-full py-2 rounded">Add Strain</button>
    <button id="find-near-me" type="button" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded mt-4 w-full">üìç Find Dispensaries Near Me</button>
  </form>

  <!-- Saved Strains List + Sort + Search -->
  <div class="max-w-xl mx-auto mt-10 bg-gray-800 p-6 rounded-lg shadow-lg">
    <div class="flex justify-between items-center mb-4">
      <h2 class="text-2xl font-semibold text-green-300">Saved Strains</h2>
      <button id="sort-button" class="text-sm bg-gray-600 px-3 py-1 rounded hover:bg-gray-700">Sort: A‚ÄìZ</button>
    </div>
    <div class="relative mb-4">
      <input id="search-bar" type="text" placeholder="Search strains..." class="w-full p-2 pl-10 rounded bg-gray-700 text-white" />
      <div class="absolute left-3 top-2.5 text-white pointer-events-none">üîç</div>
      <ul id="dropdown" class="absolute bg-gray-800 border border-gray-600 w-full mt-1 rounded hidden z-50 max-h-48 overflow-y-auto"></ul>
    </div>
    <div id="strain-list" class="space-y-4"></div>
  </div>

  <!-- Edit Modal -->
  <div id="edit-modal" class="fixed inset-0 bg-black bg-opacity-70 hidden items-center justify-center z-50">
    <div class="bg-gray-800 p-6 rounded-lg w-full max-w-md">
      <h3 class="text-xl font-bold text-green-300 mb-4">Edit Strain</h3>
      <input id="edit-name" class="w-full p-2 rounded bg-gray-700 mb-4" />
      <input id="edit-type" class="w-full p-2 rounded bg-gray-700 mb-4" />
      <textarea id="edit-description" rows="3" class="w-full p-2 rounded bg-gray-700 mb-4"></textarea>
      <textarea id="edit-notes" rows="3" placeholder="How did it make you feel?" class="w-full p-2 rounded bg-gray-700 mb-4"></textarea>
      <div class="flex space-x-1 mb-4" id="edit-stars"></div>
      <div class="flex justify-end space-x-2">
        <button onclick="closeEditModal()" class="px-4 py-2 bg-gray-600 rounded hover:bg-gray-700">Cancel</button>
        <button id="save-edit" class="px-4 py-2 bg-green-500 text-black font-bold rounded hover:bg-green-600">Save</button>
      </div>
    </div>
  </div>

  <script>
  const predefinedStrains = [
    "Blue Dream", "Girl Scout Cookies", "Sour Diesel", "OG Kush", "Pineapple Express",
    "Granddaddy Purple", "White Widow", "Northern Lights", "Green Crack", "Durban Poison", [
  "Fire Glow Storm",
  "Tropical Crack Dream",
  "Cookie Monster",
  "Tropical Glow X",
  "Tropical Crack X",
  "Electric Glow Dream",
  "White Fire OG",
  "Golden Diesel Rush",
  "Fire Buds OG",
  "Frozen Cush Rush",
  "Silver Blaze Drip",
  "Frozen Diesel Dream",
  "Wild Crack Banger",
  "Golden Juice X",
  "Silver Cush Express",
  "Golden Blaze Banger",
  "Granddaddy Purple",
  "Frozen Breeze Drip",
  "Frozen Cush Storm",
  "Wild Zing Express",
  "Silver Berry Delight",
  "Tropical Zing Drip",
  "Alaskan Thunder Fuck",
  "Fire Berry Rush",
  "Frozen Buds Dream",
  "Silver Diesel High",
  "Cherry Pie",
  "Tangie",
  "Golden Glow X",
  "Wild Diesel Express",
  "Golden Diesel High",
  "Tropical Diesel Storm",
  "Frozen Juice Express",
  "Wild Zing Drip",
  "Sour Diesel",
  "Mint Juice High",
  "Funky Glow Dream",
  "Golden Buds X",
  "Blissful Wizard",
  "Funky Zing Dream",
  "Funky Cush Dream",
  "Blueberry",
  "Funky Diesel Dream",
  "Fire Crack Delight",
  "Sticky Diesel Drip",
  "Electric Juice Dream",
  "Frozen Cush X",
  "LSD",
  "Golden Glow Rush",
  "Wild Crack High",
  "Mint Blaze X",
  "Gelato",
  "Golden Buds Delight",
  "Hindu Kush",
  "Silver Juice OG",
  "Fire Berry Banger",
  "Skywalker OG",
  "Fire Zing OG",
  "Fire Crack OG",
  "Silver Buds X",
  "Mint Berry High",
  "Mint Juice Rush",
  "Silver Zing X",
  "Mint Zing Banger",
  "Funky Zing X",
  "Wild Crack X",
  "Funky Crack Banger",
  "Fire Breeze High",
  "Fire Breeze Delight",
  "Triple OG",
  "Silver Crack Drip",
  "Wild Juice Delight",
  "Sticky Glow X",
  "Bubblegum",
  "Zkittlez",
  "Mint Breeze Express",
  "Wild Diesel Rush",
  "Silver Buds Storm",
  "Frozen Juice OG",
  "Electric Blaze Delight",
  "Forbidden Fruit",
  "Wild Zing Dream",
  "Silver Breeze Rush",
  "Girl Scout Cookies",
  "Frozen Diesel High",
  "Funky Glow OG",
  "Tropical Berry High",
  "Jillybean",
  "Sticky Crack Express",
  "Electric Glow OG",
  "Afghan Kush",
  "Golden Zing OG",
  "Frozen Blaze Express",
  "Silver Zing Delight",
  "Electric Cush High",
  "Golden Blaze High",
  "Golden Cush Storm",
  "Funky Berry Drip",
  "Wild Glow Banger",
  "Grape God",
  "Silver Diesel Storm",
  "Electric Zing Banger",
  "Fire Diesel Rush",
  "Golden Breeze Rush",
  "Fire Juice X",
  "Golden Buds OG",
  "Electric Breeze OG",
  "Electric Buds Storm",
  "Electric Cush Rush",
  "Electric Glow Rush",
  "Tropical Blaze Express",
  "Frozen Glow Storm",
  "Golden Zing Express",
  "Mint Glow Delight",
  "Frozen Cush Delight",
  "Purple Punch",
  "Wild Blaze Banger",
  "Fire Breeze X",
  "Golden Cush Dream",
  "Tropical Blaze Dream",
  "Frozen Zing Delight",
  "Mint Cush Banger",
  "Juicy Fruit",
  "Mint Cush Rush",
  "Funky Blaze Storm",
  "Silver Glow Rush",
  "Golden Zing Rush",
  "Funky Buds Drip",
  "Mango Kush",
  "Silver Juice Delight",
  "Golden Crack X",
  "Master Kush",
  "Romulan",
  "Tropical Glow Delight",
  "Tropical Breeze Delight",
  "Tropical Blaze X",
  "Funky Buds Delight",
  "Wild Breeze Storm",
  "Golden Cush High",
  "Sticky Cush High",
  "Tropical Zing X",
  "Funky Breeze Banger",
  "Frozen Diesel Rush",
  "Golden Breeze Express",
  "Funky Diesel Rush",
  "Wild Glow X",
  "Tropical Glow Dream",
  "Frozen Zing Banger",
  "Golden Glow OG",
  "Frozen Glow Delight",
  "Fire Juice Dream",
  "Runtz",
  "Electric Juice Delight",
  "God's Gift",
  "Grape Ape",
  "Tropical Glow High",
  "Wild Berry OG",
  "Silver Cush Delight",
  "Golden Berry OG",
  "Funky Crack Dream",
  "Wild Glow Drip",
  "Mint Breeze Drip",
  "Golden Crack OG",
  "Mint Breeze Dream",
  "Frozen Buds X",
  "Mint Crack Banger",
  "Sticky Juice OG",
  "Bruce Banner",
  "Sticky Zing Dream",
  "Electric Crack Drip",
  "Wild Glow Delight",
  "Harlequin",
  "Fire Buds X",
  "Electric Cush Express",
  "Sticky Cush OG",
  "Wild Juice OG",
  "Fire Cush Dream",
  "Golden Diesel Banger",
  "Electric Juice Banger",
  "Funky Blaze High",
  "Tropical Diesel Dream",
  "Fire Crack Express",
  "Tropical Berry OG",
  "Electric Crack Banger",
  "Electric Berry Banger",
  "Funky Buds High",
  "Tropical Breeze Express",
  "Electric Glow Storm",
  "Thin Mint",
  "Sticky Zing Rush",
  "Funky Buds Express",
  "Tropical Zing High",
  "Northern Lights",
  "Mint Crack Dream",
  "Fire Blaze Delight",
  "Fire OG",
  "Wild Berry Express",
  "Electric Blaze Express",
  "Silver Breeze Delight",
  "Fire Glow X",
  "Silver Blaze High",
  "Mint Zing X",
  "Wild Juice High",
  "Yoda OG",
  "Do-Si-Dos",
  "Mint Breeze OG",
  "Tropical Glow Banger",
  "Frozen Juice Banger",
  "Frozen Juice High",
  "Wild Blaze OG",
  "Funky Diesel Delight",
  "Ice Cream Cake",
  "UK Cheese",
  "Funky Breeze Delight",
  "Funky Diesel High",
  "Frozen Zing High",
  "Golden Berry Storm",
  "Wild Cush High",
  "Fire Juice Delight",
  "Wild Zing Storm",
  "Tropical Berry Rush",
  "Funky Cush OG",
  "Silver Juice Rush",
  "Mint Crack Delight",
  "White Rhino",
  "Sticky Blaze Delight",
  "Tropical Diesel OG",
  "Mint Zing Drip",
  "Frozen Diesel Banger",
  "Frozen Juice Storm",
  "Golden Cush Drip",
  "Silver Blaze Banger",
  "Funky Breeze Storm",
  "Fire Berry X",
  "Electric Cush OG",
  "Wild Cush X",
  "Wild Cush Delight",
  "Mint Crack X",
  "Wild Glow Storm",
  "Mint Diesel Dream",
  "Vanilla Kush",
  "Silver Buds Drip",
  "Electric Diesel X",
  "Frozen Juice Dream",
  "Fire Glow Delight",
  "Electric Breeze Rush",
  "Tropical Cush X",
  "Liberty Haze",
  "Frozen Juice Delight",
  "Fire Zing Rush",
  "Chemdawg",
  "Golden Breeze Storm",
  "Wild Zing High",
  "Mint Cush Storm",
  "Electric Berry X",
  "Alien OG",
  "Fire Zing Dream",
  "Funky Breeze High",
  "Wild Breeze High",
  "Electric Breeze Express",
  "Sticky Glow Rush",
  "Slurricane",
  "Silver Diesel X",
  "Stardawg",
  "Tropical Berry X",
  "Mint Cush OG",
  "9 Pound Hammer",
  "Sticky Berry Drip",
  "Snowcap",
  "Tropical Crack Delight",
  "Tropical Cush Delight",
  "Sticky Berry X",
  "Sticky Breeze Storm",
  "Silver Crack Express",
  "ACDC",
  "White Widow",
  "Mint Breeze Delight",
  "Headband",
  "Electric Juice X",
  "Golden Buds High",
  "Candyland",
  "Sticky Breeze Banger",
  "Mint Diesel High",
  "Silver Zing Express",
  "Cinex",
  "Tropical Blaze Drip",
  "Tropical Diesel Drip",
  "Tropical Buds Delight",
  "Funky Juice Delight",
  "Funky Blaze Banger",
  "Frozen Breeze Banger",
  "Fire Crack Rush",
  "Strawberry Cough",
  "Wild Cush Banger",
  "Golden Diesel X",
  "Sticky Blaze Express",
  "Sticky Berry Storm",
  "Frozen Glow X",
  "Silver Glow Delight",
  "Sticky Diesel Storm",
  "Double Dream",
  "Electric Crack Express",
  "Sticky Buds High",
  "Tropical Blaze Delight",
  "Wild Berry Dream",
  "Mint Blaze Rush",
  "Trainwreck",
  "Sticky Juice Storm",
  "Fire Breeze Rush",
  "Electric Breeze Dream",
  "Apple Fritter",
  "Bio-Diesel",
  "Green Crack",
  "Tropical Diesel Banger",
  "Frozen Berry X",
  "Frozen Berry Delight",
  "Critical Mass",
  "Mimosa",
  "Cereal Milk",
  "Sunset Sherbet",
  "Mint Cush High",
  "Golden Breeze Banger",
  "Silver Diesel Banger",
  "Fire Crack Banger",
  "Frozen Buds Delight",
  "Golden Diesel Dream",
  "Mint Buds Dream",
  "Blackberry Kush",
  "Sticky Blaze Banger",
  "Silver Breeze X",
  "Golden Glow Express",
  "Clementine",
  "Fire Breeze Storm",
  "Electric Juice Rush",
  "Chernobyl",
  "Wild Crack Drip",
  "Frozen Berry OG",
  "Golden Breeze X",
  "Mint Glow Rush",
  "Electric Blaze Banger",
  "Sticky Berry Express",
  "Tropical Zing Rush",
  "Golden Breeze Delight",
  "Fire Berry Storm",
  "Electric Glow X",
  "Golden Cush Delight",
  "Frozen Blaze Banger",
  "Funky Blaze Dream",
  "Electric Diesel Banger",
  "Funky Zing Drip",
  "Golden Crack Storm",
  "Sticky Zing High",
  "Electric Zing Delight",
  "Tropical Cush Express",
  "Sticky Diesel Dream",
  "Frozen Zing OG",
  "Wild Glow Rush",
  "Frozen Cush High",
  "Wild Buds Banger",
  "Mint Glow Drip",
  "Sticky Buds Delight",
  "Sticky Juice Dream",
  "Funky Buds Dream",
  "Electric Glow Delight",
  "Golden Blaze X",
  "Sticky Zing Delight",
  "Wild Diesel Drip",
  "Grimace",
  "Electric Breeze Delight",
  "Electric Glow Banger",
  "Silver Buds OG",
  "Sticky Blaze X",
  "Funky Crack Delight",
  "Frozen Cush Express",
  "Funky Berry Express",
  "Wild Berry Delight",
  "Flo",
  "Tropical Blaze High",
  "Frozen Crack OG",
  "Kosher Kush",
  "Cali-O",
  "Funky Zing Express",
  "Green Ribbon",
  "Mint Juice Delight",
  "Paris OG",
  "Mint Berry Storm",
  "Fire Breeze Drip",
  "Mint Juice X",
  "Silver Berry High",
  "Frozen Crack Dream",
  "Fire Cush Banger",
  "Frozen Crack Banger",
  "Funky Diesel X",
  "Tropical Zing Banger",
  "Electric Blaze OG",
  "Tropical Berry Delight",
  "Sticky Glow OG",
  "Golden Zing Delight",
  "Funky Cush Express",
  "Electric Blaze Storm",
  "Space Queen",
  "Fire Buds Drip",
  "Purple Haze",
  "Sherbet",
  "Electric Blaze X",
  "Golden Juice OG",
  "Electric Zing Drip",
  "Mint Diesel Rush",
  "Golden Glow Dream",
  "Tropical Berry Dream",
  "Funky Berry Banger",
  "Mint Breeze Rush",
  "Mint Buds Express",
  "G13",
  "Sticky Diesel Rush",
  "Sticky Berry Dream",
  "Funky Berry Delight",
  "Fire Crack Storm",
  "Golden Cush Banger",
  "Frozen Buds OG",
  "Electric Berry Express",
  "Golden Blaze Rush",
  "Funky Buds Storm",
  "Frozen Diesel Express",
  "Electric Buds Dream",
  "Fire Crack Drip",
  "Golden Juice High",
  "Durban Poison",
  "Wild Buds Express",
  "Silver Berry Dream",
  "Frozen Crack High",
  "Banana Kush",
  "Mint Crack Storm",
  "Electric Buds Drip",
  "Frozen Blaze Delight",
  "Mint Juice Banger",
  "Gorilla Glue",
  "Golden Crack Delight",
  "Silver Crack High",
  "Frozen Crack Delight",
  "Wild Blaze Rush",
  "Fire Glow Rush",
  "Sticky Breeze Rush",
  "Frozen Breeze X",
  "Silver Glow Dream",
  "Frozen Glow Express",
  "Funky Diesel Express",
  "Lemon Haze",
  "SFV OG",
  "Fire Diesel Storm",
  "Funky Juice Express",
  "Sticky Zing Drip",
  "Frozen Crack Drip",
  "Electric Blaze Drip",
  "Wild Breeze Express",
  "Silver Crack Banger",
  "Tropical Crack Express",
  "Mint Blaze High",
  "Silver Breeze Express",
  "Golden Crack Dream",
  "Mint Zing Delight",
  "Fire Blaze Dream",
  "Funky Cush Banger",
  "Jack Herer",
  "Funky Breeze Rush",
  "Tropical Juice X",
  "Electric Crack Delight",
  "Golden Zing Drip",
  "Tropical Crack Banger",
  "Mint Crack OG",
  "Chocolope",
  "Mint Buds High",
  "Wild Blaze X",
  "Tropical Diesel Rush",
  "Fire Cush Drip",
  "Golden Crack Rush",
  "Fire Berry OG",
  "Silver Blaze Express",
  "Larry OG",
  "Sticky Juice Delight",
  "Super Lemon Haze",
  "Fire Cush Delight",
  "Mint Zing OG",
  "Tropical Blaze Storm",
  "Silver Berry Rush",
  "Silver Buds Express",
  "Silver Crack Rush",
  "Funky Juice Drip",
  "Wild Zing Rush",
  "Funky Crack Drip",
  "Sticky Berry Rush",
  "Mint Breeze X",
  "Fire Buds Rush",
  "Mint Glow OG",
  "Silver Diesel Drip",
  "Sticky Juice Express",
  "Golden Zing Storm",
  "Silver Buds High",
  "Sticky Blaze High",
  "Golden Zing High",
  "Fire Juice Express",
  "Wild Blaze Dream",
  "Frozen Breeze Express",
  "Golden Glow Banger",
  "Silver Cush X",
  "Funky Crack Rush",
  "Mint Berry Delight",
  "Blue Dream",
  "Tropical Buds Drip",
  "Ewok",
  "Wild Crack Storm",
  "Silver Crack X",
  "Funky Blaze Rush",
  "Mint Zing Storm",
  "Golden Cush OG",
  "Frozen Buds Storm",
  "Electric Juice OG",
  "Lamb's Bread",
  "Wild Breeze Banger",
  "Tropical Zing Express",
  "Silver Blaze Delight",
  "Tropical Cush High",
  "Fire Crack X",
  "Fire Berry Dream",
  "Mint Blaze Storm",
  "Mint Zing Dream",
  "Tropical Blaze Banger",
  "Amnesia Haze",
  "Fire Juice OG",
  "Fire Blaze Storm",
  "Death Star",
  "Tropical Diesel X",
  "Wild Juice Storm",
  "Tropical Berry Express",
  "Wild Blaze Express",
  "Tropical Glow OG",
  "Sticky Crack Banger",
  "Mint Juice Dream",
  "Silver Juice Dream",
  "LA Confidential",
  "Electric Cush X",
  "Mint Buds Storm",
  "Sticky Berry Banger",
  "Golden Breeze OG",
  "Sticky Crack Storm",
  "OG Kush",
  "Funky Juice OG",
  "Mint Berry Rush",
  "Sticky Buds Express",
  "Tropical Berry Storm",
  "Maui Wowie",
  "Golden Blaze Delight",
  "Aurora Indica",
  "Sticky Breeze X",
  "Funky Crack X",
  "Mint Buds Delight",
  "Silver Diesel OG",
  "Mint Glow High",
  "Wild Juice Rush",
  "Wild Buds Storm",
  "Frozen Berry Banger",
  "Berry White",
  "Pineapple Express",
  "Wild Cush Storm",
  "Wild Breeze OG",
  "Wedding Cake",
  "Tropical Buds Rush",
  "Platinum OG",
  "Golden Glow Storm",
  "Tropical Glow Drip",
  "Golden Diesel Drip",
  "Silver Diesel Delight",
  "Electric Zing Storm",
  "Golden Juice Banger",
  "Frozen Blaze High",
  "Frozen Berry Storm",
  "Fire Diesel X",
  "Silver Cush OG",
  "Mint Breeze High",
  "Wild Crack Dream",
  "Frozen Zing Drip",
  "Funky Zing Banger",
  "Orange Kush",
  "Fire Zing Delight",
  "Silver Diesel Express",
  "Sticky Juice X",
  "Frozen Buds Drip",
  "Silver Juice Banger",
  "Frozen Breeze Dream",
  "Tropical Blaze OG",
  "Silver Berry OG",
  "Electric Juice High",
  "Funky Zing Rush",
  "Golden Blaze Storm",
  "Frozen Juice Drip",
  "Mint Blaze Express",
  "Fire Glow OG",
  "Tropical Breeze Drip",
  "AK-47"
]
    // You can extend this list with hundreds more if you‚Äôd like
  ];
  <!-- Core JavaScript -->
  <script>
    // Firebase setup
    const firebaseConfig = {
      apiKey: "AIzaSyBeR5kfsutaflDkMqDQJgU4lGzeXR3VuTk",
      authDomain: "weed-a53a5.firebaseapp.com",
      projectId: "weed-a53a5",
      storageBucket: "weed-a53a5.appspot.com",
      messagingSenderId: "715010576158",
      appId: "1:715010576158:web:59a2064fb4ca7ea8f8030f"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // DOM elements
    const nameInput = document.getElementById('name');
    const list = document.getElementById('strain-list');
    const searchBar = document.getElementById('search-bar');
    const dropdown = document.getElementById('dropdown');
    const sortButton = document.getElementById('sort-button');
    const editModal = document.getElementById('edit-modal');
    const editName = document.getElementById('edit-name');
    const editType = document.getElementById('edit-type');
    const editDescription = document.getElementById('edit-description');
    const editNotes = document.getElementById('edit-notes');
    const editStars = document.getElementById('edit-stars');

    // State
    let currentId = null;
    let currentRating = 0;
    let ascending = true;
    let strains = [];

    // Form submission
    document.getElementById('strain-form').addEventListener('submit', async (e) => {
      e.preventDefault();
      const name = nameInput.value.trim();
      const type = document.getElementById('type').value.trim();
      const description = document.getElementById('description').value.trim();
      const notes = document.getElementById('notes').value.trim();
      if (!name || !type || !description) return;
      await db.collection('strains').add({ name, type, description, notes, rating: 0 });
      document.getElementById('strain-form').reset();
    });

    // Lookup buttons
    document.getElementById('lookup-leafly').addEventListener('click', () => {
      const q = nameInput.value.trim();
      if (!q) return alert('Enter a strain name to lookup on Leafly.');
      window.open(`https://www.leafly.com/search?q=${encodeURIComponent(q)}`, '_blank');
    });
    document.getElementById('lookup-seedsman').addEventListener('click', () => {
      const q = nameInput.value.trim();
      if (!q) return alert('Enter a strain name to lookup on Seedsman.');
      window.open(`https://www.seedsman.com/en/cannabis-seeds/${encodeURIComponent(q)}`, '_blank');
    });
    document.getElementById('find-near-me').addEventListener('click', () => {
      window.open('https://www.google.com/maps/search/dispensaries+near+me', '_blank');
    });

    // Firestore listener
    db.collection('strains').onSnapshot(snapshot => {
      strains = snapshot.docs.map(d => ({ id: d.id, data: d.data() }));
      renderList();
    });

    function renderList() {
      list.innerHTML = '';
      const sorted = strains.sort((a,b) => ascending
        ? a.data.name.localeCompare(b.data.name)
        : b.data.name.localeCompare(a.data.name)
      );
      sorted.forEach(({id,data}) => {
        const div = document.createElement('div');
        div.className = 'bg-gray-700 p-4 rounded hover:bg-gray-600 transition cursor-pointer';
        div.innerHTML = `
          <h3 class="text-xl font-bold text-green-400">${data.name}</h3>
          <p class="italic text-sm text-gray-300">${data.type}</p>
          <p class="mt-2 text-white">${data.description}</p>
          <p class="mt-2 text-sm italic text-gray-400">${data.notes || ''}</p>
          <div class="flex space-x-1 mt-2">
            ${[1,2,3,4,5].map(i => `
              <span class="star text-2xl cursor-pointer" data-doc="${id}" data-rating="${i}">‚òÖ</span>
            `).join('')}
          </div>`;
        div.addEventListener('click', () => openEditModal(id,data));
        div.querySelectorAll('.star').forEach(star => {
          const r = +star.dataset.rating;
          star.style.color = r <= data.rating ? 'gold' : 'black';
          star.addEventListener('click', async ev => {
            ev.stopPropagation();
            await db.collection('strains').doc(id).update({ rating: r });
          });
        });
        list.appendChild(div);
      });
    }

    // Sort toggle
    sortButton.addEventListener('click', () => {
      ascending = !ascending;
      sortButton.textContent = `Sort: ${ascending? 'A‚ÄìZ':'Z‚ÄìA'}`;
      renderList();
    });

    // Search dropdown
  searchBar.addEventListener('input', () => {
    const val = searchBar.value.toLowerCase();
    dropdown.innerHTML = '';
    if (!val) return dropdown.classList.add('hidden');

    const matchesFromSaved = strains
      .filter(({ data }) => data.name.toLowerCase().includes(val))
      .map(({ data }) => data.name);

    const matchesFromPredefined = predefinedStrains
      .filter(name => name.toLowerCase().includes(val));

    // Combine and deduplicate
    const combinedMatches = [...new Set([...matchesFromSaved, ...matchesFromPredefined])];

    combinedMatches.forEach(name => {
      const li = document.createElement('li');
      li.className = 'p-2 hover:bg-gray-600 cursor-pointer';
      li.textContent = name;
      li.onclick = () => window.open(`/notepad.html?strain=${encodeURIComponent(name)}`, '_blank');
      dropdown.appendChild(li);
    });

    dropdown.classList.toggle('hidden', combinedMatches.length === 0);
  });

    // Edit modal logic
    function openEditModal(id,data) {
      currentId = id;
      editName.value = data.name;
      editType.value = data.type;
      editDescription.value = data.description;
      editNotes.value = data.notes||'';
      currentRating = data.rating||0;
      renderEditStars();
      editModal.classList.remove('hidden');
      editModal.classList.add('flex');
    }
    function closeEditModal() {
      editModal.classList.add('hidden');
      editModal.classList.remove('flex');
    }
    function renderEditStars() {
      editStars.innerHTML = '';
      for (let i=1;i<=5;i++) {
        const star = document.createElement('span');
        star.textContent = '‚òÖ';
        star.className = 'text-2xl cursor-pointer';
        star.style.color = i<=currentRating ? 'gold':'black';
        star.onclick = () => { currentRating=i; renderEditStars(); };
        editStars.appendChild(star);
      }
    }
    document.getElementById('save-edit').addEventListener('click', async () => {
      const name=editName.value.trim(), type=editType.value.trim();
      const desc=editDescription.value.trim(), notes=editNotes.value.trim();
      await db.collection('strains').doc(currentId)
        .update({ name, type, description: desc, notes, rating: currentRating });
      closeEditModal();
    });
  </script>
</body>
</html>
